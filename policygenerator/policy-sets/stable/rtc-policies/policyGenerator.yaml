apiVersion: policy.open-cluster-management.io/v1
kind: PolicyGenerator
metadata:
  name: rtc-policies
placementBindingDefaults:
  name: binding-policy-openshift-rtc
policyDefaults:
  categories:
    - CM Configuration Management
  controls: 
    - CM-2 Baseline Configuration
  namespace: rtc-policies
  policySets:
    - openshift-rtc
  remediationAction: enforce
  severity: medium
  standards:
    - NIST SP 800-53
policies:
# Cluster OAuth Policies - start
- name: policy-oauth-config
  categories:
    - CM Configuration Management
  controls:
    - CM-2 Baseline Configuration
  manifests:
    - path: input-oauth/
- name: policy-oauth-sync-resources
  categories:
    - CM Configuration Management
  controls:
    - CM-2 Baseline Configuration
  manifests:
    - path: input-oauth/oauth-sync-resources.yaml
  policySets:
    - openshift-rtc-hub
# Cluster OAuth Policies - end
# Cluster GitOps/ArgoCD Policies - start
- name: policy-gitops-operator-install
  categories:
    - CM Configuration Management
  controls:
    - CM-2 Baseline Configuration
  manifests:
    - path: input-argocd-gitops/gitops-operator-install.yaml
- name: policy-gitops-sync-resources
  categories:
    - CM Configuration Management
  controls:
    - CM-2 Baseline Configuration
  manifests:
    - path: input-argocd-gitops/gitops-sync-resources.yaml
  policySets:
    - openshift-rtc-hub
- name: policy-gitops-argocd-install
  categories:
    - CM Configuration Management
  controls:
    - CM-2 Baseline Configuration
  manifests:
    - path: input-argocd-gitops/gitops-argocd-install.yaml
# Cluster GitOps/ArgoCD Policies - end
# Cluster Kyverno Policies - start
- name: policy-fix-kyverno-roles
  categories:
    - CM Configuration Management
  controls:
    - CM-2 Baseline Configuration
  manifests:
    - path: input-kyverno
- name: policy-kyverno-clusterpolicies
  categories:
    - SI System and Information Integrity
  controls:
    - SI-5 Security Alerts Advisories and Directives
  manifests:
    - path: input-kyverno-policies
# Cluster Kyverno Policies - end
# Cluster APIServer Policies - start
- name: policy-enable-etcd-encryption
  categories:
    - SC System and Communications Protection
  controls:
    - SC-28 Protection Of Information At Rest
  standards:
    - NIST SP 800-53
  manifests:
    - path: input-apiserver/policy-enable-etcd-encryption.yaml
# Cluster APIServer Policies - start
policySets:
  - description: The OpenShift Platform Plus policy set applies several policies
      that will install the OpenShift Platform Plus products using best practices
      that allow them to work well together. This policy set is focused on 
      the components that install to the Advanced Cluster Management hub.
    name: openshift-rtc-hub
    placement:
      placementPath: input/hub-placement.yaml
  - description: The OpenShift RTC policy set applies several policies
      that will configure the RTC cluster and install desired components.
    name: openshift-rtc
    placement:
      placementPath: input/rtc-placement.yaml
